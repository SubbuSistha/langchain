# LangChain Chains — Quick Guide

## What is a Chain
A Chain is a sequence of steps where:

```
output of one step → input of next step
```

Used to build LLM workflows

---

## Flow Diagram

```
Input
  ↓
Prompt
  ↓
LLM
  ↓
Parser
  ↓
Output
```

---

## Example Chain

```python
chain = prompt | llm | parser

response = chain.invoke({"question": "India"})
```

---

## Internal Execution

```python
out1 = prompt.invoke(input)
out2 = llm.invoke(out1)
out3 = parser.invoke(out2)

return out3
```

---

## Without Chain

```python
messages = prompt.format_messages(question="India")

response = llm.invoke(messages)

result = parser.parse(response.content)
```

---

## With Chain

```python
chain = prompt | llm | parser

result = chain.invoke({"question": "India"})
```

---

## Comparison

| Aspect | Without Chain | With Chain |
|--------|-------------|------------|
| Code | Multiple steps | Single line |
| Readability | Low | High |
| Errors | More | Less |
| Reusability | Low | High |
| Maintenance | Hard | Easy |

---

## Key Concept

Chain uses pipe operator:

```
step1 | step2 | step3
```

Meaning:

```
step1 output → step2 input → step3 input
```

---

## Runnable Concept

All components must implement:

```python
invoke(input) -> output
```

Examples:
- PromptTemplate
- LLM
- OutputParser

---

## Custom Step Example

```python
from langchain_core.runnables import RunnableLambda

custom = RunnableLambda(lambda x: x + " processed")

chain = prompt | llm | custom
```

---

## Important Rule

Output of one step must match input of next step

---

## Invalid Example

```
step1 returns dict
step2 expects string
```

Will fail

---

## Mental Models

Function chaining:
```
f(g(h(x)))
```

Unix pipe:
```
cmd1 | cmd2 | cmd3
```

Java stream:
```
input → map → process → collect
```

---

## Sample Use Case

```python
chain = prompt | llm | parser

response = chain.invoke({"question": "India"})

print(response.country)
print(response.states)
```

---

## Use Case Flow

```
User Input
  ↓
Prompt
  ↓
LLM
  ↓
Parser
  ↓
Structured Output
```

---

## Why Use Chains

- Clean code
- Automatic flow
- Reusable pipelines
- Standard LangChain pattern

---

## Summary

Chain = pipeline of runnables

Each step implements:

```python
invoke(input) -> output
```

Final flow:

```
input → step1 → step2 → step3 → output
```